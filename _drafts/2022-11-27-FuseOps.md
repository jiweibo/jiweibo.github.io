---
layout: post
title:  "FuseOps for tvm"
date:   2022-11-27 12:00:00 +0800
description: tvm
categories: tvm
tags: [tvm]
location: Beijing,China
---

# 概述

在深度学习领域，想必大家对算子融合的概念都不陌生，算子融合通常是指将多个算子融合成单个kernel，从而避免了中间结果的访存和kernel launch的开销。本章主要介绍TVM中的算子融合，也称之为自动fusion；

在TVM中对算子进行了分类：

```c++
/*! \brief operator pattern used in graph fusion */
enum OpPatternKind {
  // Elementwise operation
  kElemWise = 0,
  // Broadcasting operator, can always map output axis to the input in order.
  // for example :code:`out[i, ax1, j, ax2] = input[i, j]`.
  // Note that the axis need to be in order so transpose is not a bcast operator.
  kBroadcast = 1,
  // Injective operator, can always injectively map output axis to a single input axis.
  // All injective operator can still be safely fused to injective and reduction.
  kInjective = 2,
  // Communicative reduction operator.
  kCommReduce = 3,
  // Complex operation, can still fuse elemwise operations into its output.
  // but cannot chain another complex op
  kOutEWiseFusable = 4,
  // The pattern for tuple nodes. Can fuse into subsequent injective ops,
  // but treated specially
  kTuple = 7,
  // Opaque operation, cannot fuse anything.
  kOpaque = 8
};
```




# References

1. https://arxiv.org/pdf/1802.04799.pdf